<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; Navigating the Unix Filesystem – Bash for HPC</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./running-stuff.html" rel="next">
<link href="./intro-unix.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="application/json" class="js-hypothesis-config">
{
  "theme": "clean",
  "openSidebar": false
}
</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./filesystems.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Navigating the Unix Filesystem</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Bash for HPC</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hpc-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">HPC Basics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hpc-safety.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">HPC Security and Safety</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro-unix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Everything about Unix/Linux they didn’t teach you</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./filesystems.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Navigating the Unix Filesystem</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./running-stuff.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Running Executables on HPC</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./scripting-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Shell Scripting Basics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./interactive_shell.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Interactively Testing Scripts in Nodes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./container-concepts.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Container Basics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./running_containers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Working with containers</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./working-with-wdl.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Working with WDL</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./r-commandline.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Running a R script on the command line</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-objectives" id="toc-learning-objectives" class="nav-link active" data-scroll-target="#learning-objectives"><span class="header-section-number">5.1</span> Learning Objectives</a></li>
  <li><a href="#visual-table-of-contents" id="toc-visual-table-of-contents" class="nav-link" data-scroll-target="#visual-table-of-contents"><span class="header-section-number">5.2</span> Visual Table of Contents</a></li>
  <li><a href="#sec-filesystems" id="toc-sec-filesystems" class="nav-link" data-scroll-target="#sec-filesystems"><span class="header-section-number">5.3</span> FH users: the main filesystems</a>
  <ul class="collapse">
  <li><a href="#a-simplified-workflow-fhfast-and-fhtemp" id="toc-a-simplified-workflow-fhfast-and-fhtemp" class="nav-link" data-scroll-target="#a-simplified-workflow-fhfast-and-fhtemp"><span class="header-section-number">5.3.1</span> A Simplified Workflow: <code>/fh/fast/</code> and <code>/fh/temp/</code></a></li>
  <li><a href="#another-approach" id="toc-another-approach" class="nav-link" data-scroll-target="#another-approach"><span class="header-section-number">5.3.2</span> Another Approach</a></li>
  <li><a href="#sec-motuz" id="toc-sec-motuz" class="nav-link" data-scroll-target="#sec-motuz"><span class="header-section-number">5.3.3</span> Transferring Files between Filesystems</a></li>
  <li><a href="#when-in-doubt-pwd" id="toc-when-in-doubt-pwd" class="nav-link" data-scroll-target="#when-in-doubt-pwd"><span class="header-section-number">5.3.4</span> When in doubt: <code>pwd</code></a></li>
  </ul></li>
  <li><a href="#sec-home" id="toc-sec-home" class="nav-link" data-scroll-target="#sec-home"><span class="header-section-number">5.4</span> Going <code>/home</code>: <code>~/</code></a></li>
  <li><a href="#sec-paths" id="toc-sec-paths" class="nav-link" data-scroll-target="#sec-paths"><span class="header-section-number">5.5</span> Absolute versus relative paths</a>
  <ul class="collapse">
  <li><a href="#keep-everything-in-folders" id="toc-keep-everything-in-folders" class="nav-link" data-scroll-target="#keep-everything-in-folders"><span class="header-section-number">5.5.1</span> Keep Everything in Folders</a></li>
  </ul></li>
  <li><a href="#sec-project" id="toc-sec-project" class="nav-link" data-scroll-target="#sec-project"><span class="header-section-number">5.6</span> Project/folder based workflows</a></li>
  <li><a href="#sec-moving" id="toc-sec-moving" class="nav-link" data-scroll-target="#sec-moving"><span class="header-section-number">5.7</span> Moving Things Around</a></li>
  <li><a href="#file-permissions" id="toc-file-permissions" class="nav-link" data-scroll-target="#file-permissions"><span class="header-section-number">5.8</span> File Permissions</a>
  <ul class="collapse">
  <li><a href="#for-more-info" id="toc-for-more-info" class="nav-link" data-scroll-target="#for-more-info"><span class="header-section-number">5.8.1</span> For More Info</a></li>
  </ul></li>
  <li><a href="#common-unix-directories" id="toc-common-unix-directories" class="nav-link" data-scroll-target="#common-unix-directories"><span class="header-section-number">5.9</span> Common Unix Directories</a></li>
  <li><a href="#whats-next" id="toc-whats-next" class="nav-link" data-scroll-target="#whats-next"><span class="header-section-number">5.10</span> What’s Next?</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Navigating the Unix Filesystem</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="learning-objectives" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="learning-objectives"><span class="header-section-number">5.1</span> Learning Objectives</h2>
<p>After reading this chapter, you should be able to:</p>
<ul>
<li><strong>Navigate</strong> the HPC filesystem using both <em>absolute</em> and <em>relative</em> paths</li>
<li><strong>Identify</strong> the shared filesystems associated with your cluster</li>
<li><strong>Develop Scripts</strong> that use multiple filesystems to process data</li>
<li><strong>Explain</strong> the benefits of a folder-based approach to organizing your analysis</li>
<li><strong>Move</strong> Files between filesystems and folders</li>
</ul>
</section>
<section id="visual-table-of-contents" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="visual-table-of-contents"><span class="header-section-number">5.2</span> Visual Table of Contents</h2>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart TD
    A["Main Filesystems on FH"] --&gt; B
    click A "#sec-filesystems"
    B["Home Directories"] --&gt; C
    click B "#sec-home"
    C["Absolute/Relative Paths"] --&gt; D
    click C "#sec-paths"
    D["Project Based File Structures"] --&gt; E
    click D "#sec-project"
    E["Moving Things Around"]
    click E "#sec-moving"
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="sec-filesystems" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="sec-filesystems"><span class="header-section-number">5.3</span> FH users: the main filesystems</h2>
<p>When working on the Fred Hutch HPC, there are three main filesystems you should consider:</p>
<ul>
<li><code>/home/</code> - The home filesystem. Your scripts can live here. Also where your configuration files (such as <code>.bashrc</code>) live.</li>
<li><code>/fh/fast/</code> (also known as fast) - Research storage. Raw files and processed results should live here.</li>
<li><code>/fh/temp/</code> (also known as temp) - The temporary filesystem. This filesystem is faster to access for gizmo nodes on the cluster, so files can be copied to for computation. The output files you generate should be moved back into an appropriate folder on <code>/fh/fast/</code>. Note that files on <code>/fh/temp/</code> will be deleted after 30 days.</li>
</ul>
<section id="a-simplified-workflow-fhfast-and-fhtemp" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="a-simplified-workflow-fhfast-and-fhtemp"><span class="header-section-number">5.3.1</span> A Simplified Workflow: <code>/fh/fast/</code> and <code>/fh/temp/</code></h3>
<p>A simple approach is to have your scripts also live in your project folder in <code>fast</code>. Then, you can sync the project in <code>/fh/fast/</code> over to <code>/fh/temp/</code>, run the scripts in <code>/fh/temp/</code>, and then sync the two folders again. You can do the file sync’ing in both directions with Motuz (<a href="#sec-motuz" class="quarto-xref"><span>Section 5.3.3</span></a>), which has its own advantages.</p>
<p>If you want to go this route, you should think about using a Folder Based Workflow (<a href="#sec-project" class="quarto-xref"><span>Section 5.6</span></a>), where everything lives in a folder.</p>
<p>Another thing to consider is to have a backup of the scripts that is either on your own machine or in GitHub. You can do this by using your <code>.gitignore</code> to exclude the data and results.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    A["Fast\n/fh/fast/my_lab/project/\nRaw Data &amp; Scripts"] --"1. Sync Data\n&amp; scripts"--&gt;B
    B["Temp\n/fh/temp/my_lab/project\n2. Run Scripts here"] --"3. Sync\nresults"--&gt;A
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="another-approach" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="another-approach"><span class="header-section-number">5.3.2</span> Another Approach</h3>
<p>Below is a a diagram with another way to work with these multiple filesystems.</p>
<ol type="1">
<li>We transfer the raw files to be processed from <code>/fh/fast/</code> to our directory <code>/fh/temp/</code>. For example, a set of <code>.bam</code> files.</li>
<li>We run our scripts from <code>/home/</code>, on the raw files in <code>/fh/temp/</code> and produce results in <code>/fh/temp/</code>.</li>
<li>We transfer our results from <code>/fh/temp/</code> to <code>/fh/fast/</code>.</li>
</ol>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    A["Home Directory\n/home/tladera2/\nScripts"] --"2. run scripts"--&gt; C
    B["Fast\n/fh/fast/tladera2\nResearch Data"] --"1. transfer\nraw files"--&gt; C
    C["Temp\n/fh/temp/tladera2"] --"3. transfer\nresults"--&gt; B
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="sec-motuz" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="sec-motuz"><span class="header-section-number">5.3.3</span> Transferring Files between Filesystems</h3>
<p>Your main mechanism for getting files to and from fast and scratch is <a href="https://sciwiki.fredhutch.org/compdemos/motuz/">Motuz</a>, which is a GUI based file transfer utility.</p>
<p>One of the advantages of Motuz is that it supports file resuming in case of disconnection, avoiding having to reupload the whole batch of files over again.</p>
<p>Motuz also supports file transfers between other filesystems at FH, including the FH Amazon S3 bucket. Highly recommended.</p>
</section>
<section id="when-in-doubt-pwd" class="level3" data-number="5.3.4">
<h3 data-number="5.3.4" class="anchored" data-anchor-id="when-in-doubt-pwd"><span class="header-section-number">5.3.4</span> When in doubt: <code>pwd</code></h3>
<p>The <code>pwd</code> command (short for <em>present working directory</em>) will let you know your current location in the filesystem. Knowing your current directory is critical when using <em>relative</em> file paths.</p>
</section>
</section>
<section id="sec-home" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="sec-home"><span class="header-section-number">5.4</span> Going <code>/home</code>: <code>~/</code></h2>
<p>There is one important file alias you should always remember: <code>~/</code> is shorthand for your own home directory.</p>
<p>Depending on the linux distribution, this can be a different location. On the FH filesystem, when I use <code>~/</code>, it maps to:</p>
<p><code>/home/tladera2/</code></p>
<p>The home directory is also important because it is where your configuration files live, such as <code>.bashrc</code> (see <a href="intro-unix.html#sec-bashrc" class="quarto-xref"><span>Section 4.4.4</span></a>).</p>
<p>Depending on how you work, you may want to store your scripts and workflows in <code>/home/</code>. Some people prefer to keep their scripts, data, and results in a single folder. For more info, see <a href="#sec-project" class="quarto-xref"><span>Section 5.6</span></a>.</p>
</section>
<section id="sec-paths" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="sec-paths"><span class="header-section-number">5.5</span> Absolute versus relative paths</h2>
<p>Absolute paths contain all the information needed to find a file in a file system from the root <code>/</code> directory. For example, this would be an absolute path:</p>
<pre><code>/fh/fast/laderast/immuno_project/raw_data/chr2.fa.gz</code></pre>
<p>In terms of folder structure, this is what this looks like:</p>
<pre><code>/
├── fh
│   └──fast
│       └──laderast
|            └──immuno_project
│                 └──raw_data
│                    └──chr2.fa.gz</code></pre>
<p>Absolute paths always start with <code>/</code>, because that is the root directory, where all the top folders and files live.</p>
<p>Relative paths break up an absolute path into two pieces of information: 1) your current directory and 2) the path <em>relative</em> to that directory. Relative paths are really helpful because things don’t break when you move your folder or files.</p>
<p>If my current working directory is the directory <code>/fh/fast/laderas_t/immuno_project/</code>, then the relative path to that same file would be:</p>
<pre><code>raw_data/chr2.fa.gz</code></pre>
<p>We can visualize the relative path like this, where our working directory is indicated by a star</p>
<pre><code>/
├── fh/fast/laderast/immuno_project/ *
|      ^working directory        └──raw_data
│                                   └──chr2.fa.gz
                                    ^relative path</code></pre>
<p>Note that this relative path does not start with a <code>/</code>, because our current directory isn’t the root directory. Relative paths are incredibly useful when scripting in a reproducible manner, such as using project-based workflows to process files in a single folder.</p>
<section id="keep-everything-in-folders" class="level3" data-number="5.5.1">
<h3 data-number="5.5.1" class="anchored" data-anchor-id="keep-everything-in-folders"><span class="header-section-number">5.5.1</span> Keep Everything in Folders</h3>
<p>We need to talk about code and data organization. For the FH system, we have a <code>/home/</code> directory, and if we have generated research data, a <code>/fh/fast/</code> directory. If we want our scripts to live in <code>/home/</code> and our data is in <code>/fh/temp/</code>, we’ll need to refer to each of these file locations.</p>
<p>Ideally, we want to make the naming conventions of our code and our data as similar as possible.</p>
</section>
</section>
<section id="sec-project" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="sec-project"><span class="header-section-number">5.6</span> Project/folder based workflows</h2>
<p>On a particular machine, using <em>absolute</em> paths is safe. However, you do this at the cost of <em>portability</em> - code that you write on one machine may not run on another.</p>
<p>If you ever anticipate doing the analysis on a separate machine, using project structures with relative paths is the safest. For example, you may want to move from the on-premise FH system to working with the data in AWS.</p>
<p>Here’s one example of putting everything into a single folder:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="ex">my_project</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> data</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> ├── chr1.fa.gz</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> ├── chr2.fa.gz</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> └── chr3.fa.gz</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> results</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> run_workflow.sh</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="ex">└──</span> scripts</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>    <span class="ex">└──</span> run_bowtie.sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In the above example, our project is named <code>my_project</code>, and there are three folders inside it: <code>data/</code>, <code>results/</code>, and <code>scripts/</code>. Our main script for running is <code>my_project/run_workflow.sh</code>. Because this script is in the root folder, we can refer to the <code>data/</code> folder to process files:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">./scripts/run_bowtie.sh</span> data/<span class="pp">*</span>.fa.gz results/</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>When we run <code>run_workflow.sh</code>, it will execute <code>run_bowtie.sh</code> on all of the files in <code>data/</code>, and save them in <code>results/</code>, resulting in the following updated structure.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">my_project</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> data</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> ├── chr1.fa.gz</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> ├── chr2.fa.gz</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> └── chr3.fa.gz</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> results</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> ├── chr1.bam</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> ├── chr2.bam</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="ex">│&nbsp;&nbsp;</span> └── chr3.bam</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="ex">├──</span> run_workflow.sh</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="ex">└──</span> scripts</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="ex">└──</span> run_bowtie.sh</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You may have seen relative paths such as <code>../another_directory/</code> - the <code>..</code> means to go up a directory in the file hierarchy, and then look in that directory for the <code>another_directory/</code> directory. I try to avoid using relative paths like these.</p>
<p>In general for portability and reproducibility, you will want to use relative paths <strong>within a directory</strong>, and avoid using relative paths like <code>../../my_folder</code>, where you are navigating up. In general, use relative paths to navigate down.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Why This is Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>When you start executing scripts, it’s important to know where the results go. When you execute SAMtools on a file in <code>/fh/temp/</code>, for example, where does the output go?</p>
<p>Workflow Runners such as Cromwell and Nextflow will output into certain file structures by default. This can be changed, but knowing the default behavior is super helpful when you don’t specify an output directory.</p>
</div>
</div>
</section>
<section id="sec-moving" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="sec-moving"><span class="header-section-number">5.7</span> Moving Things Around</h2>
<p>A lot of the time, we need to move files between shared filesystems. One filesystem might be good at storage and be backed up on a regular basis, while another filesystem might be better for temporary work on the cluster.</p>
<p>You might be familiar with <code>mv</code>, which lets you move files around in Unix. One thing to keep in mind when you’re <code>mv</code>ing things to a new folder that there is a difference between:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> log.txt my_folder   <span class="co">## renames log.txt to my_folder</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mv</span> log.txt my_folder/  <span class="co">## moves log.txt to be in my_folder</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>This is one thing that trips me up all the time.</p>
<p>This is one situation where using a GUI such as Motuz (<a href="#sec-motuz" class="quarto-xref"><span>Section 5.3.3</span></a>) can be very helpful. You don’t have to worry about accidentally renaming files.</p>
<p>Other tools for sync’ing between filesystems include <code>rsync</code>, which requires careful reading of documentation.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Things I always forget: the difference between <code>/home/mydir/</code> and <code>home/mydir/</code>
</div>
</div>
<div class="callout-body-container callout-body">
<p>Some things that trip me up all the time. The difference between</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="ex">/home/mydir/</span>    <span class="co">#absolute path</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="ex">home/mydir/</span>    <span class="co">#relative path</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The first one is an <em>absolute path</em>, and the second is a <em>relative path</em>. Your clue is the leading <code>/</code> at the beginning of a path. If you’re getting <code>file not found</code> messages, check to make sure the path is the right format.</p>
</div>
</div>
</section>
<section id="file-permissions" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="file-permissions"><span class="header-section-number">5.8</span> File Permissions</h2>
<p>File permissions are <em>metadata</em> that are attached to file objects. They are how the system prevents certain files from being messed with.</p>
<p>All files have the following level of access permissions:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Level</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Owner-level</td>
<td>The owner of the file</td>
</tr>
<tr class="even">
<td>Group-level</td>
<td>The group of the file</td>
</tr>
<tr class="odd">
<td>Everyone</td>
<td>The rest of the world</td>
</tr>
</tbody>
</table>
<p>Each level has the following type of access</p>
<table class="caption-top table">
<colgroup>
<col style="width: 11%">
<col style="width: 32%">
<col style="width: 35%">
<col style="width: 20%">
</colgroup>
<thead>
<tr class="header">
<th>Type</th>
<th>Description</th>
<th>Abbreviation</th>
<th>Example</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Read</td>
<td>Level can only read contents of file</td>
<td><code>r</code></td>
<td>A list of users in a text file</td>
</tr>
<tr class="even">
<td>Write</td>
<td>Level can write to the file</td>
<td><code>w</code></td>
<td>Appending an entry to the end of a log</td>
</tr>
<tr class="odd">
<td>Execute</td>
<td>Level can run the file as an executable</td>
<td><code>x</code></td>
<td>samtools</td>
</tr>
</tbody>
</table>
<p>The cardinal rule to remember is that</p>
<blockquote class="blockquote">
<p>If you want to run a file as an executable, you need to have executable level permission.</p>
</blockquote>
<p>For example, if I want to run a script called <code>run_samtools.sh</code> in my directory like this:</p>
<pre><code>./run_samtools.sh my_bam_file.bam</code></pre>
<p>I will need to have execute privileges at the user, group, or others level.</p>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Helpful unix permissions situations
</div>
</div>
<div class="callout-body-container callout-body">
<p>I tend to just go by memory when setting file permissions. If I have collaborators who just want to set</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Situation</th>
<th>Command</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Only I can execute/read/write a file</td>
<td><code>chmod 700 &lt;file&gt;</code></td>
</tr>
<tr class="even">
<td>Only I and my group can read a file</td>
<td><code>chmod 110 &lt;file&gt;</code></td>
</tr>
<tr class="odd">
<td>Grant a group read permissions</td>
<td><code>chmod 710 &lt;file&gt;</code></td>
</tr>
<tr class="even">
<td>Make executable/read/write by all</td>
<td><code>chmod 777 &lt;file?</code></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-simple callout-none no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Even if you don’t have execute permissions
</div>
</div>
<div class="callout-body-container callout-body">
<p>With bash scripts, you can still run them if you have <code>read</code> permissions. You can still run bash scripts by using the <code>bash</code> command:</p>
<pre><code>bash run_samtools.sh my_bam_file.bam</code></pre>
<p>This has saved me a number of times.</p>
</div>
</div>
<section id="for-more-info" class="level3" data-number="5.8.1">
<h3 data-number="5.8.1" class="anchored" data-anchor-id="for-more-info"><span class="header-section-number">5.8.1</span> For More Info</h3>
<ul>
<li><a href="https://mason.gmu.edu/~montecin/UNIXpermiss.htm" class="uri">https://mason.gmu.edu/~montecin/UNIXpermiss.htm</a></li>
</ul>
</section>
</section>
<section id="common-unix-directories" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="common-unix-directories"><span class="header-section-number">5.9</span> Common Unix Directories</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/1725596486922.gif" class="img-fluid figure-img"></p>
<figcaption>Common Unix Directories across all systems (image via <a href="https://bytebytego.com/">ByteByteGo</a>)</figcaption>
</figure>
</div>
</section>
<section id="whats-next" class="level2" data-number="5.10">
<h2 data-number="5.10" class="anchored" data-anchor-id="whats-next"><span class="header-section-number">5.10</span> What’s Next?</h2>
<p>Now that we have learned the different filesystems and how to specify them and navigate them, we are now able to try out shell scripting (<a href="scripting-basics.html" class="quarto-xref"><span>Chapter 7</span></a>).</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./intro-unix.html" class="pagination-link" aria-label="Everything about Unix/Linux they didn't teach you">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Everything about Unix/Linux they didn’t teach you</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./running-stuff.html" class="pagination-link" aria-label="Running Executables on HPC">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Running Executables on HPC</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>